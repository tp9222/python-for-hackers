Java.perform(function () {
    var SharedPreferences = Java.use("android.content.SharedPreferences");
    var Editor = Java.use("android.content.SharedPreferences$Editor");

    var prefs = Java.use("androidx.security.crypto.EncryptedSharedPreferences");

    prefs.getString.overload('java.lang.String', 'java.lang.String').implementation = function (key, def) {
        var result = this.getString(key, def);
        console.log("Decrypted Pref Key: " + key + " => " + result);
        return result;
    };
});
