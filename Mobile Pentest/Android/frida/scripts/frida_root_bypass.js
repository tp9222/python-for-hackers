Java.perform(function () {
    console.log("[*] Root detection bypass script injected.");

    // 1. Bypass Build.TAGS
    var Build = Java.use("android.os.Build");
    var TAGS = Build.class.getDeclaredField("TAGS");
    TAGS.setAccessible(true);
    TAGS.set(null, "release-keys");
    console.log("[+] Build.TAGS spoofed to release-keys");

    // 2. Bypass File.exists() for known root paths
    var File = Java.use("java.io.File");
    File.exists.implementation = function () {
        var path = this.getAbsolutePath();
        if (path === "/system/xbin/su" || path === "/system/app/Superuser.apk") {
            console.log("[+] Bypassing file.exists() for: " + path);
            return false;
        }
        return this.exists.call(this);
    };
});
